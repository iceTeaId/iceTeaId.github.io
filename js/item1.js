(function(h,l,o,j){var m=function(){},a=m()===false?false:true,t=function(x,y,A){var w={},z=m();x.css(w)},r=("ontouchstart" in l),n=l.navigator.pointerEnabled||l.navigator.msPointerEnabled,p=function(w){if(r){return true}if(!n||typeof w==="undefined"||typeof w.pointerType==="undefined"){return false}if(typeof w.MSPOINTER_TYPE_MOUSE!=="undefined"){if(w.MSPOINTER_TYPE_MOUSE!=w.pointerType){return true}}else{if(w.pointerType!="mouse"){return true}}return false};h.fn.imageLightbox=function(J){var J=h.extend({selector:'id="imagelightbox"',allowedTypes:"png|jpg|jpeg|gif",animationSpeed:250,preloadNext:true,enableKeyboard:true,quitOnEnd:false,quitOnImgClick:false,quitOnDocClick:true,onStart:false,onEnd:false,onLoadStart:false,onLoadEnd:false},J),D=h([]),E=h(),z=h(),A=h(),F=0,B=0,w=0,C=false,y=function(K){return h(K).prop("tagName").toLowerCase()=="a"&&(new RegExp(".("+J.allowedTypes+")$","i")).test(h(K).attr("href").split("?")[0])},G=function(){if(!z.length){return true}var L=l.innerWidth*0.8,M=l.innerHeight*0.9,K=new Image();K.src=z.attr("src");K.onload=function(){F=K.width;B=K.height;if(F>L||B>M){var N=F/B>L/M?F/L:B/M;F/=N;B/=N}if(L<M){F=F+40;B=B+30}else{B=B+4}h(".imagelightbox-wrap").css({width:F+"px",height:B+"px",top:(l.innerHeight-B)/2+"px",left:(l.innerWidth-F)/2+"px"})}},x=function(K){if(C){return false}K=typeof K==="undefined"?false:K=="left"?1:-1;if(z.length){if(K!==false&&(D.length<2||(J.quitOnEnd===true&&((K===-1&&D.index(E)==0)||(K===1&&D.index(E)==D.length-1))))){I();return false}var L={opacity:0};if(a){t(z,(100*K)-w+"px",J.animationSpeed/1000)}else{L.left=parseInt(z.css("left"))+100*K+"px"}z.animate(L,J.animationSpeed,function(){H()});w=0}C=true;if(J.onLoadStart!==false){J.onLoadStart()}setTimeout(function(){var P=h("#sd-column-page a[data-imagelightbox=show]").length;var M=D.index(E);M=M+=1;var Q=h('<div class="slidenum">'+M+" / "+P+"</div>");Q.appendTo(".imagelightbox-wrap");z=h("<img "+J.selector+" />").attr("src",E.attr("href")).load(function(){z.appendTo(".imagelightbox-wrap");G();var U={opacity:1};z.css("opacity",0);if(a){t(z,-100*K+"px",0);setTimeout(function(){t(z,0+"px",J.animationSpeed/1000)},50)}else{var T=parseInt(z.css("left"));U.left=T+"px";z.css("left",T-100*K+"px")}z.animate(U,J.animationSpeed,function(){C=false;if(J.onLoadEnd!==false){J.onLoadEnd()}});if(J.preloadNext){var S=D.eq(D.index(E)+1);if(!S.length){S=D.eq(0)}h("<img />").attr("src",S.attr("href")).load()}}).error(function(){if(J.onLoadEnd!==false){J.onLoadEnd()}});var R=0,N=0,O=0;z.on(n?"pointerup MSPointerUp":"click",function(S){S.preventDefault();if(J.quitOnImgClick){I();return false}if(p(S.originalEvent)){return true}var T=(S.pageX||S.originalEvent.pageX)-S.target.offsetLeft;E=D.eq(D.index(E)-(F/2>T?1:-1));if(!E.length){E=D.eq(F/2>T?D.length:0)}x(F/2>T?"left":"right")}).on("touchstart pointerdown MSPointerDown",function(S){if(!p(S.originalEvent)||J.quitOnImgClick){return true}if(a){O=parseInt(z.css("left"))}R=S.originalEvent.pageX||S.originalEvent.touches[0].pageX}).on("touchmove pointermove MSPointerMove",function(S){if(!p(S.originalEvent)||J.quitOnImgClick){return true}S.preventDefault();N=S.originalEvent.pageX||S.originalEvent.touches[0].pageX;w=R-N;if(a){t(z,-w+"px",0)}else{z.css("left",O-w+"px")}}).on("touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",function(S){if(!p(S.originalEvent)||J.quitOnImgClick){return true}if(Math.abs(w)>50){E=D.eq(D.index(E)-(w<0?1:-1));if(!E.length){E=D.eq(w<0?D.length:0)}x(w>0?"right":"left")}else{if(a){t(z,0+"px",J.animationSpeed/1000)}else{z.animate({left:O+"px"},J.animationSpeed/2)}}})},J.animationSpeed+100)},H=function(){if(!z.length){return false}h(".slidenum").remove();z.remove();z=h()},I=function(){if(!z.length){return false}z.animate({opacity:0},J.animationSpeed,function(){H();h(".imagelightbox-wrap").removeAttr("style");C=false;if(J.onEnd!==false){J.onEnd()}})};h(l).on("resize",G);if(J.quitOnDocClick){h(o).on(r?"touchend":"click",function(K){if(z.length&&!h(K.target).is(z)){I()}})}if(J.enableKeyboard){h(o).on("keyup",function(K){if(!z.length){return true}K.preventDefault();if(K.keyCode==27){I()}if(K.keyCode==37||K.keyCode==39){E=D.eq(D.index(E)-(K.keyCode==37?1:-1));if(!E.length){E=D.eq(K.keyCode==37?D.length:0)}x(K.keyCode==37?"left":"right")}})}h(o).on("click",this.selector,function(K){D=h([]);h(g).each(function(){if(!y(this)){return true}D=D.add(h(this))});if(!y(this)){return true}K.preventDefault();if(C){return false}C=false;if(J.onStart!==false){J.onStart()}E=h(this);x()});this.each(function(){if(!y(this)){return true}D=D.add(h(this))});this.switchImageLightbox=function(L){var M=D.eq(L);if(M.length){var K=D.index(E);E=M;x(L<K?"left":"right")}return this};this.quitImageLightbox=function(){I();return this};return this};var u=function(){h('<div id="imagelightbox-loading"><div></div></div>').appendTo("body")},k=function(){h("#imagelightbox-loading").remove()},s=function(){h('<div id="imagelightbox-overlay"></div>').appendTo("body")},c=function(){h("#imagelightbox-overlay").remove()},f=function(w){if(h("#imagelightbox-close").length<1){h('<button type="button" id="imagelightbox-close" title="Close"></button>').appendTo(".imagelightbox-wrap").on("click touchend",function(){h(this).remove();w.quitImageLightbox();return false})}},i=function(){h("#imagelightbox-close").remove()},q=function(){var w=h('a[href="'+h("#imagelightbox").attr("src")+'"] img').attr("alt")||"";if(w.length>0){h('<div id="imagelightbox-caption">'+w+"</div>").appendTo(".imagelightbox-wrap")}},b=function(){h("#imagelightbox-caption").remove()},v=function(y,x){var A=h('<button type="button" class="imagelightbox-arrow imagelightbox-arrow-left"></button><button type="button" class="imagelightbox-arrow imagelightbox-arrow-right"></button>');A.appendTo(".imagelightbox-wrap");var w=h(x+'[href="'+h("#imagelightbox").attr("src")+'"]'),z=w.index(x);A.on("click touchend",function(C){C.preventDefault();var B=h(this);if(B.hasClass("imagelightbox-arrow-left")){z=z-1;if(!h(x).eq(z).length){z=h(x).length}}else{z=z+1;if(!h(x).eq(z).length){z=0}}y.switchImageLightbox(z);return false});h("#imagelightbox").on("click",function(C){var B=h(this);z=z+1;if(!h(x).eq(z).length){z=0}y.switchImageLightbox(z);return false})},e=function(){h(".imagelightbox-arrow").remove()};var g="a[data-imagelightbox=show]";var d=h(g).imageLightbox({onStart:function(){s();f(d);v(d,g)},onEnd:function(){c();b();i();e();k()},onLoadStart:function(){b();u();f();v()},onLoadEnd:function(){q();k();f(d);v(d,g)}})})(jQuery,window,document);